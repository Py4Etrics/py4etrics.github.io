Traceback (most recent call last):
  File "/Users/runner/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/Users/runner/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/nbclient/client.py", line 1085, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/Users/runner/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/Users/runner/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/Users/runner/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/Users/runner/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/nbclient/client.py", line 551, in async_execute
    await self.async_execute_cell(
  File "/Users/runner/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/nbclient/client.py", line 846, in async_execute_cell
    self._check_raise_for_error(cell, exec_reply)
  File "/Users/runner/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/nbclient/client.py", line 748, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
stage_2 = 'lwage ~ 1 + educ_fit'

res_stage_2 =IV2SLS.from_formula(stage_2, data=mroz).fit(cov_type='unadjusted')  # OLSæŽ¨å®š

print(res_stage_2.summary.tables[1])
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
[0;32m/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/ipykernel_1284/1230274855.py[0m in [0;36m<module>[0;34m[0m
[1;32m      1[0m [0mstage_2[0m [0;34m=[0m [0;34m'lwage ~ 1 + educ_fit'[0m[0;34m[0m[0;34m[0m[0m
[1;32m      2[0m [0;34m[0m[0m
[0;32m----> 3[0;31m [0mres_stage_2[0m [0;34m=[0m[0mIV2SLS[0m[0;34m.[0m[0mfrom_formula[0m[0;34m([0m[0mstage_2[0m[0;34m,[0m [0mdata[0m[0;34m=[0m[0mmroz[0m[0;34m)[0m[0;34m.[0m[0mfit[0m[0;34m([0m[0mcov_type[0m[0;34m=[0m[0;34m'unadjusted'[0m[0;34m)[0m  [0;31m# OLSæŽ¨å®š[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m      4[0m [0;34m[0m[0m
[1;32m      5[0m [0mprint[0m[0;34m([0m[0mres_stage_2[0m[0;34m.[0m[0msummary[0m[0;34m.[0m[0mtables[0m[0;34m[[0m[0;36m1[0m[0;34m][0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/linearmodels/iv/model.py[0m in [0;36mfrom_formula[0;34m(formula, data, weights)[0m
[1;32m    902[0m         """
[1;32m    903[0m         [0mparser[0m [0;34m=[0m [0mIVFormulaParser[0m[0;34m([0m[0mformula[0m[0;34m,[0m [0mdata[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 904[0;31m         [0mdep[0m[0;34m,[0m [0mexog[0m[0;34m,[0m [0mendog[0m[0;34m,[0m [0minstr[0m [0;34m=[0m [0mparser[0m[0;34m.[0m[0mdata[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    905[0m         [0mmod[0m [0;34m=[0m [0mIV2SLS[0m[0;34m([0m[0mdep[0m[0;34m,[0m [0mexog[0m[0;34m,[0m [0mendog[0m[0;34m,[0m [0minstr[0m[0;34m,[0m [0mweights[0m[0;34m=[0m[0mweights[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    906[0m         [0mmod[0m[0;34m.[0m[0mformula[0m [0;34m=[0m [0mformula[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/linearmodels/iv/_utility.py[0m in [0;36mdata[0;34m(self)[0m
[1;32m    145[0m         [0;34m"""Returns a tuple containing the dependent, exog, endog and instruments"""[0m[0;34m[0m[0;34m[0m[0m
[1;32m    146[0m         [0mself[0m[0;34m.[0m[0m_eval_env[0m [0;34m+=[0m [0;36m1[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 147[0;31m         [0mout[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0mdependent[0m[0;34m,[0m [0mself[0m[0;34m.[0m[0mexog[0m[0;34m,[0m [0mself[0m[0;34m.[0m[0mendog[0m[0;34m,[0m [0mself[0m[0;34m.[0m[0minstruments[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    148[0m         [0mself[0m[0;34m.[0m[0m_eval_env[0m [0;34m-=[0m [0;36m1[0m[0;34m[0m[0;34m[0m[0m
[1;32m    149[0m         [0;32mreturn[0m [0mout[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/linearmodels/iv/_utility.py[0m in [0;36mexog[0;34m(self)[0m
[1;32m    166[0m         [0;34m"""Exogenous variables"""[0m[0;34m[0m[0;34m[0m[0m
[1;32m    167[0m         [0mexog_fmla[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0mcomponents[0m[0;34m[[0m[0;34m"exog"[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 168[0;31m         exog = model_matrix(
[0m[1;32m    169[0m             [0mexog_fmla[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m
[1;32m    170[0m             [0mself[0m[0;34m.[0m[0m_data[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/formulaic/sugar.py[0m in [0;36mmodel_matrix[0;34m(formula, data, context, **kwargs)[0m
[1;32m     12[0m         [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m     13[0m             [0mcontext[0m [0;34m=[0m [0;32mNone[0m  [0;31m# pragma: no cover[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 14[0;31m     [0;32mreturn[0m [0mFormula[0m[0;34m([0m[0mformula[0m[0;34m)[0m[0;34m.[0m[0mget_model_matrix[0m[0;34m([0m[0mdata[0m[0;34m,[0m [0mcontext[0m[0;34m=[0m[0mcontext[0m[0;34m,[0m [0;34m**[0m[0mkwargs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m
[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/formulaic/formula.py[0m in [0;36mget_model_matrix[0;34m(self, data, context, materializer, ensure_full_rank, **kwargs)[0m
[1;32m     61[0m         [0;32mif[0m [0;32mnot[0m [0minspect[0m[0;34m.[0m[0misclass[0m[0;34m([0m[0mmaterializer[0m[0;34m)[0m [0;32mor[0m [0;32mnot[0m [0missubclass[0m[0;34m([0m[0mmaterializer[0m[0;34m,[0m [0mFormulaMaterializer[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m     62[0m             [0;32mraise[0m [0mFormulaMaterializerInvalidError[0m[0;34m([0m[0;34m"Materializers must be subclasses of `formulaic.materializers.FormulaMaterializer`."[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 63[0;31m         [0;32mreturn[0m [0mmaterializer[0m[0;34m([0m[0mdata[0m[0;34m,[0m [0mcontext[0m[0;34m=[0m[0mcontext[0m [0;32mor[0m [0;34m{[0m[0;34m}[0m[0;34m)[0m[0;34m.[0m[0mget_model_matrix[0m[0;34m([0m[0mself[0m[0;34m,[0m [0mensure_full_rank[0m[0;34m=[0m[0mensure_full_rank[0m[0;34m,[0m [0;34m**[0m[0mkwargs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m     64[0m [0;34m[0m[0m
[1;32m     65[0m     [0;32mdef[0m [0mdifferentiate[0m[0;34m([0m[0mself[0m[0;34m,[0m [0;34m*[0m[0mvars[0m[0;34m,[0m [0muse_sympy[0m[0;34m=[0m[0;32mFalse[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/formulaic/materializers/base.py[0m in [0;36mget_model_matrix[0;34m(self, spec, ensure_full_rank, na_action, output)[0m
[1;32m    155[0m         [0;31m# Step 5: Collate factors into one ModelMatrix[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m    156[0m         return ModelMatrix(
[0;32m--> 157[0;31m             self._combine_columns([
[0m[1;32m    158[0m                 [0;34m([0m[0mname[0m[0;34m,[0m [0mvalues[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    159[0m                 [0;32mfor[0m [0mterm[0m[0;34m,[0m [0mscoped_terms[0m[0;34m,[0m [0mscoped_cols[0m [0;32min[0m [0mcols[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/formulaic/materializers/pandas.py[0m in [0;36m_combine_columns[0;34m(self, cols, spec, drop_rows)[0m
[1;32m    127[0m         [0;32mif[0m [0mspec[0m[0;34m.[0m[0moutput[0m [0;34m==[0m [0;34m'numpy'[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    128[0m             [0;32mreturn[0m [0mnumpy[0m[0;34m.[0m[0mstack[0m[0;34m([0m[0;34m[[0m[0mcol[0m[0;34m[[0m[0;36m1[0m[0;34m][0m [0;32mfor[0m [0mcol[0m [0;32min[0m [0mcols[0m[0;34m][0m[0;34m,[0m [0maxis[0m[0;34m=[0m[0;36m1[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 129[0;31m         return pandas.DataFrame(
[0m[1;32m    130[0m             {
[1;32m    131[0m                 [0mcol[0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m:[0m [0mcol[0m[0;34m[[0m[0;36m1[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/pandas/core/frame.py[0m in [0;36m__init__[0;34m(self, data, index, columns, dtype, copy)[0m
[1;32m    635[0m         [0;32melif[0m [0misinstance[0m[0;34m([0m[0mdata[0m[0;34m,[0m [0mdict[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    636[0m             [0;31m# GH#38939 de facto copy defaults to False only in non-dict cases[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 637[0;31m             [0mmgr[0m [0;34m=[0m [0mdict_to_mgr[0m[0;34m([0m[0mdata[0m[0;34m,[0m [0mindex[0m[0;34m,[0m [0mcolumns[0m[0;34m,[0m [0mdtype[0m[0;34m=[0m[0mdtype[0m[0;34m,[0m [0mcopy[0m[0;34m=[0m[0mcopy[0m[0;34m,[0m [0mtyp[0m[0;34m=[0m[0mmanager[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    638[0m         [0;32melif[0m [0misinstance[0m[0;34m([0m[0mdata[0m[0;34m,[0m [0mma[0m[0;34m.[0m[0mMaskedArray[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    639[0m             [0;32mimport[0m [0mnumpy[0m[0;34m.[0m[0mma[0m[0;34m.[0m[0mmrecords[0m [0;32mas[0m [0mmrecords[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/pandas/core/internals/construction.py[0m in [0;36mdict_to_mgr[0;34m(data, index, columns, dtype, typ, copy)[0m
[1;32m    500[0m         [0;31m# TODO: can we get rid of the dt64tz special case above?[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m    501[0m [0;34m[0m[0m
[0;32m--> 502[0;31m     [0;32mreturn[0m [0marrays_to_mgr[0m[0;34m([0m[0marrays[0m[0;34m,[0m [0mcolumns[0m[0;34m,[0m [0mindex[0m[0;34m,[0m [0mdtype[0m[0;34m=[0m[0mdtype[0m[0;34m,[0m [0mtyp[0m[0;34m=[0m[0mtyp[0m[0;34m,[0m [0mconsolidate[0m[0;34m=[0m[0mcopy[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    503[0m [0;34m[0m[0m
[1;32m    504[0m [0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/pandas/core/internals/construction.py[0m in [0;36marrays_to_mgr[0;34m(arrays, columns, index, dtype, verify_integrity, typ, consolidate)[0m
[1;32m    123[0m [0;34m[0m[0m
[1;32m    124[0m         [0;31m# don't force copy because getting jammed in an ndarray anyway[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 125[0;31m         [0marrays[0m [0;34m=[0m [0m_homogenize[0m[0;34m([0m[0marrays[0m[0;34m,[0m [0mindex[0m[0;34m,[0m [0mdtype[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    126[0m         [0;31m# _homogenize ensures[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m    127[0m         [0;31m#  - all(len(x) == len(index) for x in arrays)[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/pandas/core/internals/construction.py[0m in [0;36m_homogenize[0;34m(data, index, dtype)[0m
[1;32m    623[0m                 [0mval[0m [0;34m=[0m [0mlib[0m[0;34m.[0m[0mfast_multiget[0m[0;34m([0m[0mval[0m[0;34m,[0m [0moindex[0m[0;34m.[0m[0m_values[0m[0;34m,[0m [0mdefault[0m[0;34m=[0m[0mnp[0m[0;34m.[0m[0mnan[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    624[0m [0;34m[0m[0m
[0;32m--> 625[0;31m             val = sanitize_array(
[0m[1;32m    626[0m                 [0mval[0m[0;34m,[0m [0mindex[0m[0;34m,[0m [0mdtype[0m[0;34m=[0m[0mdtype[0m[0;34m,[0m [0mcopy[0m[0;34m=[0m[0;32mFalse[0m[0;34m,[0m [0mraise_cast_failure[0m[0;34m=[0m[0;32mFalse[0m[0;34m[0m[0;34m[0m[0m
[1;32m    627[0m             )

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/pandas/core/construction.py[0m in [0;36msanitize_array[0;34m(data, index, dtype, copy, raise_cast_failure, allow_2d)[0m
[1;32m    596[0m                 [0msubarr[0m [0;34m=[0m [0mmaybe_infer_to_datetimelike[0m[0;34m([0m[0msubarr[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    597[0m [0;34m[0m[0m
[0;32m--> 598[0;31m     [0msubarr[0m [0;34m=[0m [0m_sanitize_ndim[0m[0;34m([0m[0msubarr[0m[0;34m,[0m [0mdata[0m[0;34m,[0m [0mdtype[0m[0;34m,[0m [0mindex[0m[0;34m,[0m [0mallow_2d[0m[0;34m=[0m[0mallow_2d[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    599[0m [0;34m[0m[0m
[1;32m    600[0m     [0;32mif[0m [0misinstance[0m[0;34m([0m[0msubarr[0m[0;34m,[0m [0mnp[0m[0;34m.[0m[0mndarray[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/pandas/core/construction.py[0m in [0;36m_sanitize_ndim[0;34m(result, data, dtype, index, allow_2d)[0m
[1;32m    647[0m             [0;32mif[0m [0mallow_2d[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    648[0m                 [0;32mreturn[0m [0mresult[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 649[0;31m             [0;32mraise[0m [0mValueError[0m[0;34m([0m[0;34m"Data must be 1-dimensional"[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    650[0m         [0;32mif[0m [0mis_object_dtype[0m[0;34m([0m[0mdtype[0m[0;34m)[0m [0;32mand[0m [0misinstance[0m[0;34m([0m[0mdtype[0m[0;34m,[0m [0mExtensionDtype[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    651[0m             [0;31m# i.e. PandasDtype("O")[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m

[0;31mValueError[0m: Data must be 1-dimensional
ValueError: Data must be 1-dimensional




<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>推論 &#8212; Pythonで学ぶ入門計量経済学</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/myadmonitions.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-6SP1Y69WEX"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-6SP1Y69WEX');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '11_Inference';</script>
    <link rel="canonical" href="https://py4etrics.github.io/11_Inference.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="大標本特性" href="12_Asymptotics.html" />
    <link rel="prev" title="残差診断" href="10_Residuals.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">Pythonで学ぶ入門計量経済学</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Pythonの学習</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="part_1.html">目次と内容</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_Python_Basics.html">Pythonの基礎</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_NumPy.html">NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_Pandas.html">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_Matplotlib.html">Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_SciPy_stats.html">SciPy.stats</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_things_to_note.html">Tipsと注意点</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Pythonを使った計量経済分析</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="part_2.html">目次と内容</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_Review_of_Statistics.html">統計学の簡単な復習</a></li>
<li class="toctree-l1"><a class="reference internal" href="list_of_terms.html">計量経済学用語</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_Simple_Regression.html">単回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_Multiple_Regression.html">重回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_Residuals.html">残差診断</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">推論</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_Asymptotics.html">大標本特性</a></li>
<li class="toctree-l1"><a class="reference internal" href="13_Dummies.html">質的変数と回帰分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="14_Hetero.html">不均一分散</a></li>
<li class="toctree-l1"><a class="reference internal" href="15_Pooling.html">プーリング・データとパネル・データ</a></li>
<li class="toctree-l1"><a class="reference internal" href="16_linearmodels.html"><code class="docutils literal notranslate"><span class="pre">linearmodels</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="17_Panel.html">パネル・データ分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="18_Zero_Conditional_Mean.html">GM仮定４が満たされない場合</a></li>
<li class="toctree-l1"><a class="reference internal" href="19_IV2SLS.html">操作変数法と２段階OLS</a></li>
<li class="toctree-l1"><a class="reference internal" href="20_LogitProbit.html">離散選択モデル</a></li>
<li class="toctree-l1"><a class="reference internal" href="21_TruncregTobitHeckit.html">制限従属変数モデル</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">番外編</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="part_3.html">目次と内容</a></li>
<li class="toctree-l1"><a class="reference internal" href="Descriptive_stats_vs_Graphs.html">記述統計とグラフ</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_source.html">Data</a></li>
<li class="toctree-l1"><a class="reference external" href="https://py4macro.github.io">Pythonで学ぶマクロ経済学 (中級＋レベル)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://py4basics.github.io">経済学のためのPython入門</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/Py4Etrics/py4etrics.github.io/source?urlpath=tree/11_Inference.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/Py4Etrics/py4etrics.github.io/blob/source/11_Inference.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/11_Inference.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>推論</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">説明：仮説検定</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#t"><span class="math notranslate nohighlight">\(t\)</span>検定</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tp">説明：<span class="math notranslate nohighlight">\(t\)</span>値と<span class="math notranslate nohighlight">\(p\)</span>値</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><span class="math notranslate nohighlight">\(t\)</span>値と<span class="math notranslate nohighlight">\(p\)</span>値の例</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><span class="math notranslate nohighlight">\(t\)</span>値</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#p"><span class="math notranslate nohighlight">\(p\)</span>値</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">回帰分析と<span class="math notranslate nohighlight">\(t\)</span>検定</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">信頼区間</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">信頼区間の計算</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">信頼区間の図示</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#f"><span class="math notranslate nohighlight">\(F\)</span>検定</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">回帰分析</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">例１</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">手計算</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">メソッドを使う</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">例２</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>推論<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<div name="html-admonition" style="font-size: 0.8em">
<input type="button" onclick="location.href='https://translate.google.com/translate?hl=&sl=ja&tl=en&u='+window.location;" value="Google translation" style="color:#ffffff;background-color:#008080; height:25px" onmouseover="this.style.background='#99ccff'" onmouseout="this.style.background='#008080'"/> in English or the language of your choice.
</div><br><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span><span class="p">,</span> <span class="n">f</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">wooldridge</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h2>説明：仮説検定<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>仮説検定は以下の手順でおこなう。</p>
<ol class="arabic simple">
<li><p>母集団のパラメータについて帰無仮説（Null Hypothesis）と対立仮説（Alternative Hypothesis）を設定する。</p>
<ul class="simple">
<li><p>帰無仮説は棄却するかどうかの判断の対象となる仮説（例えば，<span class="math notranslate nohighlight">\(\hat{\beta}_1=0\)</span>）</p></li>
<li><p>対立仮説は帰無仮説に相反する仮説（例えば，<span class="math notranslate nohighlight">\(\hat{\beta}_1\neq 0\)</span>）</p></li>
</ul>
</li>
<li><p>適切な検定統計量を決め，判定するための有意水準を予め決める。</p>
<ul class="simple">
<li><p>有意水準 ＝ 下で説明する<strong>第一種過誤の確率</strong></p></li>
</ul>
</li>
<li><p>計算した検定統計量の値と有意水準に対応する値を比較することにより，帰無仮説を棄却するかしないかを判断する。２つの可能性しかない。</p>
<ul class="simple">
<li><p>帰無仮説を棄却する（対立仮説を採択する）。</p></li>
<li><p>帰無仮説を棄却できない（対立仮説を採択できない）。</p></li>
</ul>
</li>
</ol>
<hr class="docutils" />
<p>検定をおこなう際には間違いが発生する。それをまとめたのが次の表である。</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>帰無仮説は真</p></th>
<th class="head"><p>帰無仮説は偽</p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>帰無仮説を棄却できない</p></td>
<td><p>正しい結論</p></td>
<td><p>第２種過誤</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>帰無仮説を棄却</p></td>
<td><p>第１種過誤</p></td>
<td><p>正しい結論</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>検定を警察の行動に例えて次のように考えることもできる。</p>
<ul class="simple">
<li><p>帰無仮説 <span class="math notranslate nohighlight">\(\Rightarrow\)</span> 「無罪」</p></li>
<li><p>帰無仮説の棄却 <span class="math notranslate nohighlight">\(\Rightarrow\)</span> 「逮捕」</p></li>
<li><p>帰無仮説を棄却しない <span class="math notranslate nohighlight">\(\Rightarrow\)</span> 「逮捕しない」</p></li>
<li><p>第１種過誤 <span class="math notranslate nohighlight">\(\Rightarrow\)</span>「冤罪で逮捕」</p></li>
<li><p>第２種過誤 <span class="math notranslate nohighlight">\(\Rightarrow\)</span>「真犯人を取り逃がす」</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head text-center"><p>無実は真</p></th>
<th class="head text-center"><p>無実は偽</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>逮捕しない</p></td>
<td class="text-center"><p>正しい結論</p></td>
<td class="text-center"><p>取り逃す</p></td>
</tr>
<tr class="row-odd"><td><p>逮捕</p></td>
<td class="text-center"><p>冤罪</p></td>
<td class="text-center"><p>正しい結論</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>統計的優位性とは，帰無仮説が正しい場合，帰無仮説の内容が発生した確率が非常に低い場合を指す。即ち，発生イベントが非常に起こりにくく，偶然のの可能性が非常に高い場合である。</p></li>
<li><p>第一種過誤は，帰無仮説が正しい場合に棄却すると発生する。慣例でその確率を<span class="math notranslate nohighlight">\(\alpha\)</span>で表す。<span class="math notranslate nohighlight">\(\alpha=0.05\)</span>がよく使われるが，これを使う場合，間違って正しい帰無仮説を棄却する確率は最大5%まで許容するという意味になる。</p></li>
</ul>
</section>
<section id="t">
<h2><span class="math notranslate nohighlight">\(t\)</span>検定<a class="headerlink" href="#t" title="Permalink to this heading">#</a></h2>
<section id="tp">
<h3>説明：<span class="math notranslate nohighlight">\(t\)</span>値と<span class="math notranslate nohighlight">\(p\)</span>値<a class="headerlink" href="#tp" title="Permalink to this heading">#</a></h3>
<p>新たな仮定を導入する。</p>
<ul class="simple">
<li><p>仮定６：誤差項は説明変数は独立であり正規分布に従う（誤差項の正規性）</p></li>
</ul>
<div class="math notranslate nohighlight">
\[u\sim N\left(0,\sigma^2\right)\]</div>
<p>仮定１〜６を<strong>Classical Linear Model (CLM) Assumptions</strong>（CLM仮定）と呼ぶ。</p>
<hr class="docutils" />
<p>CLM仮定の下では：</p>
<ul>
<li><p>OLS推定量は正規分布に従う。</p>
<div class="math notranslate nohighlight">
\[
    \hat{\beta}_j\sim N\left(\beta_j,\text{Var}\left(\hat{\beta}_j\right)\right)
    \]</div>
</li>
<li><p>OLS推定量の標準誤差を使い標準化すると以下が成立する。</p>
<div class="math notranslate nohighlight">
\[
    \frac{\hat{\beta}_j-\beta_j}{\text{se}\left(\hat{\beta}_j\right)}\sim t_{n-k-1}
    \]</div>
<p>ここで<span class="math notranslate nohighlight">\(t_{n-k-1}\)</span>は自由度<span class="math notranslate nohighlight">\(n-k-1\)</span>の<span class="math notranslate nohighlight">\(t\)</span>分布を表している。<span class="math notranslate nohighlight">\(n\)</span>は標本の大きさ，<span class="math notranslate nohighlight">\(k\)</span>は定数項以外の説明変数の数である（定数項がある場合）。</p>
</li>
</ul>
<hr class="docutils" />
<p>この関係を使うことによりOLS推定量の検定が可能となる。</p>
<ul>
<li><p>帰無仮説：<span class="math notranslate nohighlight">\(H_0:\hat{\beta}_j=0\)</span></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(H_0\)</span>が正しい場合，<span class="math notranslate nohighlight">\(t\)</span>統計量は次の分布に従う。</p>
<div class="math notranslate nohighlight">
\[
        t_{\hat{\beta}_j}\equiv\frac{\hat{\beta}_j}{\text{se}\left(\hat{\beta}_j\right)}\sim t_{n-k-1}
        \]</div>
</li>
</ul>
</li>
<li><p>対立仮説と棄却ルール（<span class="math notranslate nohighlight">\(\alpha=\)</span>有意水準）：</p>
<ul>
<li><p>右側検定：<span class="math notranslate nohighlight">\(H_A:\hat{\beta}_j&gt;0\)</span></p>
<div class="math notranslate nohighlight">
\[
        t_{\hat{\beta}_j}&gt;t_c(\alpha)&gt;0\quad\Rightarrow\quad H_0\text{を棄却する}
        \]</div>
</li>
<li><p>左側検定：<span class="math notranslate nohighlight">\(H_A:\hat{\beta}_j&lt;0\)</span></p>
<div class="math notranslate nohighlight">
\[
        t_{\hat{\beta}_j}&lt;t_c(\alpha)&lt;0\quad\Rightarrow\quad H_0\text{を棄却する}
        \]</div>
</li>
<li><p>両側検定：<span class="math notranslate nohighlight">\(H_A:\hat{\beta}_j\neq 0\)</span></p>
<div class="math notranslate nohighlight">
\[
        \left|t_{\hat{\beta}_j}\right|&gt;t_c(\alpha/2)&gt;0\quad\Rightarrow\quad H_0\text{を棄却する}
        \]</div>
</li>
</ul>
</li>
</ul>
<p>ここで，<span class="math notranslate nohighlight">\(t_c(\alpha)\)</span>は有意水準<span class="math notranslate nohighlight">\(\alpha\)</span>に対応する片側検定の棄却臨界値であり、<span class="math notranslate nohighlight">\(t_c(\alpha/2)\)</span>は有意水準<span class="math notranslate nohighlight">\(\alpha\)</span>に対応する両側検定の棄却臨界値である。</p>
<hr class="docutils" />
<p><strong>＜<span class="math notranslate nohighlight">\(p\)</span>値＞</strong></p>
<p><span class="math notranslate nohighlight">\(p\)</span>値は，帰無仮説が正しい場合に観測された事象が起こった確率である。即ち、<span class="math notranslate nohighlight">\(p\)</span>値が非常に低い場合（例えば、0.01）、帰無仮説のもとで発生した事象は非常に起こりにくく，偶然のの可能性が非常に高いことを意味する。また、第一種過誤の確率は非常に低いことも意味する。</p>
<p><span class="math notranslate nohighlight">\(p\)</span>値を使う場合の検定手順</p>
<ul class="simple">
<li><p>棄却するための有意水準 <span class="math notranslate nohighlight">\(\alpha\)</span>を決める（例えば，0.05）</p></li>
<li><p><span class="math notranslate nohighlight">\(p値\leq \alpha\)</span>の場合，<span class="math notranslate nohighlight">\(\text{H}_0\)</span>を棄却</p></li>
</ul>
</section>
<section id="id3">
<h3><span class="math notranslate nohighlight">\(t\)</span>値と<span class="math notranslate nohighlight">\(p\)</span>値の例<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>定数項があり</p>
<ul class="simple">
<li><p>有意水準：<span class="math notranslate nohighlight">\(\alpha=0.05\)</span></p></li>
<li><p>標本の大きさ：<span class="math notranslate nohighlight">\(n=30\)</span></p></li>
<li><p>説明変数の数（定数項以外）：<span class="math notranslate nohighlight">\(k=5\)</span></p></li>
</ul>
<p>の場合を考えよう。</p>
<section id="id4">
<h4><span class="math notranslate nohighlight">\(t\)</span>値<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h4>
<p>右側検定の場合の<span class="math notranslate nohighlight">\(t_c(0.05)\)</span>は次の値となる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">dof</span> <span class="o">=</span> <span class="mi">30</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span>

<span class="n">t_right</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>  <span class="c1"># t.ppfについてはscipy.statsを参照</span>
<span class="n">t_right</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.7108820799094275
</pre></div>
</div>
</div>
</div>
<p>左側検定の場合の<span class="math notranslate nohighlight">\(t_c(0.05)\)</span>は次の値となる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_left</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
<span class="n">t_left</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.7108820799094282
</pre></div>
</div>
</div>
</div>
<p>両側検定の場合の<span class="math notranslate nohighlight">\(t_c(0.05)\)</span>は、<span class="math notranslate nohighlight">\(1-a/2\)</span>を使うと次のコードとなる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_both</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
<span class="n">t_both</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0638985616280205
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(a/2\)</span>を使うと次のコードで同じ値を計算できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">abs</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">dof</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.063898561628021
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">abs()</span></code>は絶対値を計算する関数である。</p>
</section>
<section id="p">
<h4><span class="math notranslate nohighlight">\(p\)</span>値<a class="headerlink" href="#p" title="Permalink to this heading">#</a></h4>
<p><span class="math notranslate nohighlight">\(p\)</span>値の計算の例として上の<code class="docutils literal notranslate"><span class="pre">t_right</span></code>、<code class="docutils literal notranslate"><span class="pre">t_left</span></code>、<code class="docutils literal notranslate"><span class="pre">t_both</span></code>を使ってみる。</p>
<p>右側検定で<span class="math notranslate nohighlight">\(t_{\hat{\beta}_j}=\)</span>
<code class="docutils literal notranslate"><span class="pre">t_right</span></code>の場合，<span class="math notranslate nohighlight">\(p\)</span>値は次の値になる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t_right</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>   <span class="c1"># t.cdfについてはscipy.statsを参照</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.050000000000000155
</pre></div>
</div>
</div>
</div>
<p>左側検定で<span class="math notranslate nohighlight">\(t_{\hat{\beta}_j}=\)</span>
<code class="docutils literal notranslate"><span class="pre">t_left</span></code>の場合，<span class="math notranslate nohighlight">\(p\)</span>値は次の値になる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t_left</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.050000000000000024
</pre></div>
</div>
</div>
</div>
<p>両側検定で<span class="math notranslate nohighlight">\(\left|t_{\hat{\beta}_j}\right|=\)</span>
<code class="docutils literal notranslate"><span class="pre">t_both</span></code>の場合，<span class="math notranslate nohighlight">\(p\)</span>値は次の値になる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span><span class="o">*</span><span class="p">(</span> <span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t_both</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.05000000000000049
</pre></div>
</div>
</div>
</div>
<figure class="align-center" id="id15">
<img alt="_images/t_p_values.jpeg" src="_images/t_p_values.jpeg" />
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">上で計算した数値の図示（累積分布関数と確率密度関数は<span class="math notranslate nohighlight">\(t\)</span>分布）。</span><a class="headerlink" href="#id15" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
<section id="id5">
<h3>回帰分析と<span class="math notranslate nohighlight">\(t\)</span>検定<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">gpa1</span></code>のデータを使った回帰分析を考えよう。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gpa</span> <span class="o">=</span> <span class="n">wooldridge</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;gpa1&#39;</span><span class="p">)</span>
<span class="n">wooldridge</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;gpa1&#39;</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>name of dataset: gpa1
no of variables: 29
no of observations: 141

+----------+--------------------------------+
| variable | label                          |
+----------+--------------------------------+
| age      | in years                       |
| soph     | =1 if sophomore                |
| junior   | =1 if junior                   |
| senior   | =1 if senior                   |
| senior5  | =1 if fifth year senior        |
| male     | =1 if male                     |
| campus   | =1 if live on campus           |
| business | =1 if business major           |
| engineer | =1 if engineering major        |
| colGPA   | MSU GPA                        |
| hsGPA    | high school GPA                |
| ACT      | &#39;achievement&#39; score            |
| job19    | =1 if job &lt;= 19 hours          |
| job20    | =1 if job &gt;= 20 hours          |
| drive    | =1 if drive to campus          |
| bike     | =1 if bicycle to campus        |
| walk     | =1 if walk to campus           |
| voluntr  | =1 if do volunteer work        |
| PC       | =1 of pers computer at sch     |
| greek    | =1 if fraternity or sorority   |
| car      | =1 if own car                  |
| siblings | =1 if have siblings            |
| bgfriend | =1 if boy- or girlfriend       |
| clubs    | =1 if belong to MSU club       |
| skipped  | avg lectures missed per week   |
| alcohol  | avg # days per week drink alc. |
| gradMI   | =1 if Michigan high school     |
| fathcoll | =1 if father college grad      |
| mothcoll | =1 if mother college grad      |
+----------+--------------------------------+

Christopher Lemmon, a former MSU undergraduate, collected these data
from a survey he took of MSU students in Fall 1994.
</pre></div>
</div>
</div>
</div>
<p>このデータセットを使い，次の問題を考える。ミシガン州立大学で学生のGPA（<code class="docutils literal notranslate"><span class="pre">colGDP</span></code>）は以下の変数とどのような関係にあるのか。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hsGPA</span></code>：高校のGPA</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ACT</span></code>：米国大学進学適性試験</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skipped</span></code>：週平均の講義欠席回数</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">formula_gpa</span> <span class="o">=</span> <span class="s1">&#39;colGPA ~ hsGPA + ACT + skipped&#39;</span>
<span class="n">res_gpa</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula_gpa</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">gpa</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">res_gpa</span></code>の属性<code class="docutils literal notranslate"><span class="pre">tvalues</span></code>を使い<span class="math notranslate nohighlight">\(t\)</span>値を表示してみる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_gpa</span><span class="o">.</span><span class="n">tvalues</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    4.191039
hsGPA        4.396260
ACT          1.393319
skipped     -3.196840
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>この値を１つ１つ棄却臨界値と比べるのも手間がかかるので、次のような関数を作成し、任意の棄却臨界値に基づき両側検定を行うことも簡単にできる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">significance_check</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    定数項がある場合のt検定をおこなう。</span>
<span class="sd">    </span>
<span class="sd">    引数：</span>
<span class="sd">        res = statsmodelsによるOLS推定結果</span>
<span class="sd">        a = 有意水準（デフォルト：0.05）</span>
<span class="sd">    返り値：</span>
<span class="sd">        帰無仮説を棄却する場合はTrueを返す。</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">dof</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">nobs</span><span class="o">-</span><span class="n">res</span><span class="o">.</span><span class="n">df_model</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">tvalues</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">tvalues</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>＜コードの説明＞</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">&quot;&quot;&quot;</span></code>と<code class="docutils literal notranslate"><span class="pre">&quot;&quot;&quot;</span></code>で囲まれた行は関数の説明であり、<code class="docutils literal notranslate"><span class="pre">docstring</span></code>と呼ばれる。<code class="docutils literal notranslate"><span class="pre">docstring</span></code>は覚え書きのようなもので、何ヶ月後の自分が読んだり、他の人が読む場合に便利となる。また、<code class="docutils literal notranslate"><span class="pre">statsmodels</span></code>などのパッケージは数多くの関数を使っており、それらにも<code class="docutils literal notranslate"><span class="pre">docstring</span></code>が追加されているのが普通である。関数<code class="docutils literal notranslate"><span class="pre">help()</span></code>を使うと<code class="docutils literal notranslate"><span class="pre">docstring</span></code>が表示される。</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">significance_check</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function significance_check in module __main__:

significance_check(res, a=0.05)
    定数項がある場合のt検定をおこなう。
    
    引数：
        res = statsmodelsによるOLS推定結果
        a = 有意水準（デフォルト：0.05）
    返り値：
        帰無仮説を棄却する場合はTrueを返す。
</pre></div>
</div>
</div>
</div>
<p>次のコードでも同じ内容を確認できる。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>significance_check?
</pre></div>
</div>
<p>関数を実行してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">significance_check</span><span class="p">(</span><span class="n">res_gpa</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept     True
hsGPA         True
ACT          False
skipped       True
dtype: bool
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">res_gpa</span></code>の属性<code class="docutils literal notranslate"><span class="pre">pvalues</span></code>から<span class="math notranslate nohighlight">\(p\)</span>値を表示してみよう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_gpa</span><span class="o">.</span><span class="n">pvalues</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    0.000050
hsGPA        0.000022
ACT          0.165780
skipped      0.001725
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res_gpa</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span><span class="o">.</span><span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      1.3896      0.332      4.191      0.000       0.734       2.045
hsGPA          0.4118      0.094      4.396      0.000       0.227       0.597
ACT            0.0147      0.011      1.393      0.166      -0.006       0.036
skipped       -0.0831      0.026     -3.197      0.002      -0.135      -0.032
==============================================================================
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coef</span></code>: OLS推定量（<span class="math notranslate nohighlight">\(\hat{\beta}_j\)</span>）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std</span> <span class="pre">err</span></code>: OLS推定量の標準誤差（<span class="math notranslate nohighlight">\(\text{se}(\hat{\beta}_j)\)</span>）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code>: <span class="math notranslate nohighlight">\(t\)</span>値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code>: <span class="math notranslate nohighlight">\(p\)</span>値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[0.025</span> <span class="pre">0.975]</span></code>: 信頼区間（次の節を参照）</p></li>
</ul>
<p>OLS推定量の標準誤差は属性<code class="docutils literal notranslate"><span class="pre">.bse</span></code>として取得できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_gpa</span><span class="o">.</span><span class="n">bse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept    0.331554
hsGPA        0.093674
ACT          0.010565
skipped      0.025999
dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id6">
<h2>信頼区間<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h2>
<section id="id7">
<h3>信頼区間の計算<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<p>信頼区間は次のように定義される。</p>
<div class="math notranslate nohighlight">
\[
\hat{\beta}_j\pm t_c(a)\cdot se\left(\hat{\beta}_j\right)
\]</div>
<p>ここで，<span class="math notranslate nohighlight">\(a\)</span>は有意水準である。</p>
<p><span class="math notranslate nohighlight">\(a=0.05\)</span>として信頼区間の解釈を考えよう。</p>
<p><strong>（間違った解釈）</strong><br>
母集団の（真の）<span class="math notranslate nohighlight">\(\beta_j\)</span>の値が信頼区間に入る確率は95％である。</p>
<p><strong>（正しい解釈）</strong><br>
標本を取りOLS推定値を計算するというプロセスを100回繰り返すとしよう。それぞれの標本は異なるため推定値<span class="math notranslate nohighlight">\(\hat{\beta}_j\)</span>と<span class="math notranslate nohighlight">\(t\)</span>値も異なることになり，100の異なる信頼区間が生成される。その内，母集団の（真の）<span class="math notranslate nohighlight">\(\beta_j\)</span>の値が信頼区間に入るのは概ね<span class="math notranslate nohighlight">\((1-0.05)\times 100\)</span>回=95回であり，概ね5回は入らない。更に，100回ではなく無限回繰り返すと，計算した信頼区間の95%には真の値が入り，5%には入らない。</p>
<p>紛らわしい解釈だが，次の理由でこの様な解釈となる。まずサイコロを考えよう。6が出る確率は1/6だが，これはサイコロの目がランダム変数だからである。当たり前だが，ランダム変数の場合に確率を考えることができる。このことを踏まえて，母集団の（真の）<span class="math notranslate nohighlight">\(\beta_j\)</span>の値を考えよう。サイコロの目と違って，<span class="math notranslate nohighlight">\(\beta_j\)</span>は定数として与えられており，ランダム変数では<strong>ない</strong>。従って，１つの信頼区間を計算した後に，その区間に（ランダム変数ではない）真の値が入るかについての確率を考えることは無意味なのである。更に言うと，<span class="math notranslate nohighlight">\(\beta_j\)</span>が信頼区間に入っているのか，もしくは，入っていないかの２つのケースしかなく，確率は1もしくは0にしかならないし，0と1の間の確率はあり得ないという事になる。一方，信頼区間の上限と下限の値はランダムであり，異なる標本を使い複数回にわたって信頼区間を計算すると，異なる上限値・下限値となる。この場合，ランダムな信頼区間が（観測不可能だが）定数である<span class="math notranslate nohighlight">\(\beta_j\)</span>を含むかの確率を考えることは意味があることであり，それが信頼区間の解釈となる。</p>
<p>では<code class="docutils literal notranslate"><span class="pre">gpa</span></code>の例を考えよう。<code class="docutils literal notranslate"><span class="pre">res_gpa</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">conf_int()</span></code>を使い信頼区間を取得できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res_gpa</span><span class="o">.</span><span class="n">conf_int</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  0         1
Intercept  0.733930  2.045178
hsGPA      0.226582  0.597050
ACT       -0.006171  0.035612
skipped   -0.134523 -0.031703
</pre></div>
</div>
</div>
</div>
<p>有意水準のオプション<code class="docutils literal notranslate"><span class="pre">alpha=</span></code>を指定することもできる（デフォルトは<code class="docutils literal notranslate"><span class="pre">0.05</span></code>）。有意水準が1％の場合は次のように指定する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res_gpa</span><span class="o">.</span><span class="n">conf_int</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  0         1
Intercept  0.523472  2.255635
hsGPA      0.167121  0.656511
ACT       -0.012877  0.042318
skipped   -0.151026 -0.015200
</pre></div>
</div>
</div>
</div>
<p>OLS推定値は1つの値を返す「点推定」だが，信頼区間は有意水準に基づく「区間推定」である。両方を確認することが大事である。例えば、<code class="docutils literal notranslate"><span class="pre">ACT</span></code>の信頼区間を考えよう。100回推定をした場合，母集団の<span class="math notranslate nohighlight">\(\beta_{ACT}\)</span>の値は95回この区間に入ることになるが，有意水準が1%でも5%でも<code class="docutils literal notranslate"><span class="pre">0</span></code>が含まれている。0の可能性が高いことを示している。</p>
</section>
<section id="id8">
<h3>信頼区間の図示<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>の<code class="docutils literal notranslate"><span class="pre">errorbar</span></code>を使い図示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coef</span> <span class="o">=</span> <span class="n">res_gpa</span><span class="o">.</span><span class="n">params</span>      <span class="c1"># 推定値</span>
<span class="n">varname</span> <span class="o">=</span> <span class="n">coef</span><span class="o">.</span><span class="n">index</span>       <span class="c1"># 変数名</span>
<span class="n">ci</span> <span class="o">=</span> <span class="n">res_gpa</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span>    <span class="c1"># 信頼区間を　ci　に入れる</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">ci</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">coef</span>  <span class="c1"># 信頼区間の幅の半分</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coef</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">varname</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">xerr</span><span class="o">=</span><span class="n">error</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># 切片以外のエラーバー</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># 垂直線</span>
<span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7fcd941a9c66f47f65b0b9429969bf277b860278166e751bca626457c1cb6efa.png" src="_images/7fcd941a9c66f47f65b0b9429969bf277b860278166e751bca626457c1cb6efa.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ACT</span></code>の信頼区間に<code class="docutils literal notranslate"><span class="pre">0</span></code>が含まれることが分かる。</p>
</section>
</section>
<section id="f">
<h2><span class="math notranslate nohighlight">\(F\)</span>検定<a class="headerlink" href="#f" title="Permalink to this heading">#</a></h2>
<section id="id9">
<h3>説明<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h3>
<p>回帰分析において複数のOLS推定量に何らかの制約が妥当かどうかを調べる際に使うのが<span class="math notranslate nohighlight">\(F\)</span>検定である。例えば，次の回帰式の場合</p>
<div class="math notranslate nohighlight">
\[
y=\beta_0+\beta_1x_1+\beta_2x_2+\beta_3x_3+u
\]</div>
<p>制約式の例として以下が挙げられる。</p>
<p><span class="math notranslate nohighlight">\(\beta_1=\beta_2=\beta_3=0\)</span></p>
<p><span class="math notranslate nohighlight">\(\beta_2=\beta_3=0\)</span></p>
<p><span class="math notranslate nohighlight">\(\beta_2=2\beta_3\)</span></p>
<hr class="docutils" />
<p>帰無仮説と対立仮説は次のようになる。</p>
<ul class="simple">
<li><p>帰無仮説：<span class="math notranslate nohighlight">\(\text{H}_0\)</span>：制約が成立する</p></li>
<li><p>対立仮説：<span class="math notranslate nohighlight">\(\text{H}_A\)</span>：制約は成立しない</p></li>
</ul>
<p>検定手順</p>
<ol class="arabic">
<li><p>制約がない回帰式を推定する。</p></li>
<li><p>制約がある回帰式を推定する。</p></li>
<li><p>次の式に従い<span class="math notranslate nohighlight">\(F\)</span>値を計算する</p>
<div class="math notranslate nohighlight">
\[
    F=\frac{\left(SSR_1-SSR_0\right)/q}{SSR_0/(n-k-1)}
    =\frac{\left(R_0^2-R_1^2\right)/q}{\left(1-R_0^2\right)/(n-k-1)}
    \sim F_{n-k-1}^q
    \]</div>
<p>左辺の<span class="math notranslate nohighlight">\(F\)</span>は<span class="math notranslate nohighlight">\(F\)</span>値、右辺の<span class="math notranslate nohighlight">\(F_{n-k-1}^q\)</span>は自由度が<span class="math notranslate nohighlight">\(q\)</span>と<span class="math notranslate nohighlight">\(n-k-1\)</span>の<span class="math notranslate nohighlight">\(F\)</span>分布。</p>
</li>
<li><p>有意水準に基づく棄却臨界値と比べる（もしくは<span class="math notranslate nohighlight">\(p\)</span>値を有意水準と比べる）</p></li>
</ol>
<p>上の式で</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(0\)</span>：制約がない変数の添え字</p></li>
<li><p><span class="math notranslate nohighlight">\(1\)</span>：制約がある変数の添え字</p></li>
<li><p><span class="math notranslate nohighlight">\(SSR\)</span>：残差変動の平方和（Residual Sum of Squares）</p></li>
<li><p><span class="math notranslate nohighlight">\(R^2\)</span>：決定係数</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span>：標本の大きさ</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span>：定数項以外の説明変数（制約がない回帰式）</p></li>
<li><p><span class="math notranslate nohighlight">\(q\)</span>：制約式の数</p></li>
</ul>
<p>名称：</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(q\)</span>を「分子の自由度」と呼ぶ</p></li>
<li><p><span class="math notranslate nohighlight">\(n-k-1\)</span>を「分母の自由度」と呼ぶ</p></li>
</ul>
<hr class="docutils" />
<p><strong>＜棄却ルール＞</strong></p>
<p><span class="math notranslate nohighlight">\(F&gt;F_c(a)\)</span>　<span class="math notranslate nohighlight">\(\Rightarrow\)</span>　<span class="math notranslate nohighlight">\(\text{H}_0\)</span>を棄却</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(F_c(a)\)</span>：棄却臨界値</p></li>
<li><p><span class="math notranslate nohighlight">\(a\)</span>：有意水準</p></li>
</ul>
<p>（注意）<span class="math notranslate nohighlight">\(F\)</span>値は必ず正の値をとる。従って，<span class="math notranslate nohighlight">\(t\)</span>検定の「右片側検定」のパターンしか存在しない。</p>
<p><strong>＜<span class="math notranslate nohighlight">\(p\)</span>値を使う場合の手順＞</strong></p>
<ul class="simple">
<li><p>棄却するための有意水準 <span class="math notranslate nohighlight">\(a\)</span>を決める（例えば，0.05）</p></li>
<li><p><span class="math notranslate nohighlight">\(p値&lt;a\)</span>の場合，<span class="math notranslate nohighlight">\(\text{H}_0\)</span>を棄却</p></li>
</ul>
</section>
<section id="id10">
<h3>回帰分析<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h3>
<p>例として米国野球選手（メジャーリーグ）に関するデータ<code class="docutils literal notranslate"><span class="pre">mlb1</span></code>を使う。</p>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mlb1</span> <span class="o">=</span> <span class="n">wooldridge</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;mlb1&#39;</span><span class="p">)</span>
<span class="n">wooldridge</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;mlb1&#39;</span><span class="p">,</span><span class="n">description</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>name of dataset: mlb1
no of variables: 47
no of observations: 353

+----------+----------------------------+
| variable | label                      |
+----------+----------------------------+
| salary   | 1993 season salary         |
| teamsal  | team payroll               |
| nl       | =1 if national league      |
| years    | years in major leagues     |
| games    | career games played        |
| atbats   | career at bats             |
| runs     | career runs scored         |
| hits     | career hits                |
| doubles  | career doubles             |
| triples  | career triples             |
| hruns    | career home runs           |
| rbis     | career runs batted in      |
| bavg     | career batting average     |
| bb       | career walks               |
| so       | career strike outs         |
| sbases   | career stolen bases        |
| fldperc  | career fielding perc       |
| frstbase | = 1 if first base          |
| scndbase | =1 if second base          |
| shrtstop | =1 if shortstop            |
| thrdbase | =1 if third base           |
| outfield | =1 if outfield             |
| catcher  | =1 if catcher              |
| yrsallst | years as all-star          |
| hispan   | =1 if hispanic             |
| black    | =1 if black                |
| whitepop | white pop. in city         |
| blackpop | black pop. in city         |
| hisppop  | hispanic pop. in city      |
| pcinc    | city per capita income     |
| gamesyr  | games per year in league   |
| hrunsyr  | home runs per year         |
| atbatsyr | at bats per year           |
| allstar  | perc. of years an all-star |
| slugavg  | career slugging average    |
| rbisyr   | rbis per year              |
| sbasesyr | stolen bases per year      |
| runsyr   | runs scored per year       |
| percwhte | percent white in city      |
| percblck | percent black in city      |
| perchisp | percent hispanic in city   |
| blckpb   | black*percblck             |
| hispph   | hispan*perchisp            |
| whtepw   | white*percwhte             |
| blckph   | black*perchisp             |
| hisppb   | hispan*percblck            |
| lsalary  | log(salary)                |
+----------+----------------------------+

Collected by G. Mark Holmes, a former MSU undergraduate, for a term
project. The salary data were obtained from the New York Times, April
11, 1993. The baseball statistics are from The Baseball Encyclopedia,
9th edition, and the city population figures are from the Statistical
Abstract of the United States.
</pre></div>
</div>
</div>
</div>
<p>このデータセットを使い，年俸（<code class="docutils literal notranslate"><span class="pre">salary</span></code>）が次の変数とどう関係するかを考える。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">years</span></code>：メジャーリーグでプレイした期間（年）</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gamesyr</span></code>：年間出場回数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bavg</span></code>：通算打率</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hrunsyr</span></code>：１シーズンあたりホームラン数</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rbinsyr</span></code>：１シーズンあたり打点</p></li>
</ul>
<p>まず制約がない回帰分析をおこなう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">formula_0</span> <span class="o">=</span> <span class="s1">&#39;np.log(salary) ~ years + gamesyr + bavg + hrunsyr + rbisyr&#39;</span>
<span class="n">res_0</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula_0</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mlb1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="id11">
<h4>例１<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h4>
<p><strong>＜制約＞</strong>
<code class="docutils literal notranslate"><span class="pre">bavg</span></code>, <code class="docutils literal notranslate"><span class="pre">hrunsyr</span></code>, <code class="docutils literal notranslate"><span class="pre">rbisyr</span></code>は<code class="docutils literal notranslate"><span class="pre">salary</span></code>に影響を与えない。</p>
<p><span class="math notranslate nohighlight">\(H_0:\;\beta_{\text{bavg}}=\beta_{\text{hrunsyr}}=\beta_{\text{rbisyr}}=0\)</span></p>
<p><span class="math notranslate nohighlight">\(H_A:\;H_0は成立しない\)</span></p>
<p>制約がある場合の回帰分析</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">formula_1</span> <span class="o">=</span> <span class="s1">&#39;np.log(salary) ~ years + gamesyr&#39;</span>
<span class="n">res_1</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="n">formula_1</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mlb1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="id12">
<h5>手計算<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h5>
<p><span class="math notranslate nohighlight">\(F\)</span>値の計算</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 決定係数</span>
<span class="n">r2_0</span> <span class="o">=</span> <span class="n">res_0</span><span class="o">.</span><span class="n">rsquared</span>
<span class="n">r2_1</span> <span class="o">=</span> <span class="n">res_1</span><span class="o">.</span><span class="n">rsquared</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">res_0</span><span class="o">.</span><span class="n">nobs</span>  <span class="c1"># 標本の大きさ</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">res_0</span><span class="o">.</span><span class="n">df_model</span>  <span class="c1"># 定数項以外の説明変数の数</span>
<span class="n">q</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># 制約式の数</span>

<span class="c1"># F値:</span>
<span class="n">F</span> <span class="o">=</span> <span class="p">(</span><span class="n">r2_0</span> <span class="o">-</span> <span class="n">r2_1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r2_0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">q</span>
<span class="n">F</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.55025352195195
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(a=0.05\)</span>の場合の棄却臨界値</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">f</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># f.ppfについてはscipy.statsを参照</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.6306414891156504
</pre></div>
</div>
</div>
</div>
<p>従って<span class="math notranslate nohighlight">\(H_0\)</span>を棄却する。</p>
<p><span class="math notranslate nohighlight">\(p\)</span>値</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="o">-</span><span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">dfn</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">dfd</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.473708139829391e-06
</pre></div>
</div>
</div>
</div>
</section>
<section id="id13">
<h5>メソッドを使う<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h5>
<p>制約式の定義</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hypotheses</span> <span class="o">=</span> <span class="s1">&#39;bavg = 0, hrunsyr = 0, rbisyr = 0&#39;</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">res_0</span></code>のメソッド<code class="docutils literal notranslate"><span class="pre">f_test</span></code>を使い、引数に上のセルで定義した制約式<code class="docutils literal notranslate"><span class="pre">hypotheses</span></code>を使う。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_f_test</span> <span class="o">=</span> <span class="n">res_0</span><span class="o">.</span><span class="n">f_test</span><span class="p">(</span><span class="n">hypotheses</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">res_f_test</span></code>に<code class="docutils literal notranslate"><span class="pre">F</span></code>検定の結果を割り当てたが、そのメソッド<code class="docutils literal notranslate"><span class="pre">summary()</span></code>を使い結果を表示する。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_f_test</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;&lt;F test: F=9.550253521951792, p=4.473708139839581e-06, df_denom=347, df_num=3&gt;&#39;
</pre></div>
</div>
</div>
</div>
<p>上の結果にある記号の意味：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">F</span></code>：<span class="math notranslate nohighlight">\(F\)</span>値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code>：<span class="math notranslate nohighlight">\(p\)</span>値</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df_denom</span></code>：分母の自由度</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df_num</span></code>：分子の自由度</p></li>
</ul>
<p>手計算と同じ結果である。</p>
</section>
</section>
<section id="id14">
<h4>例２<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h4>
<p><strong>＜制約＞</strong>
定数項以外の全ての説明変数は<code class="docutils literal notranslate"><span class="pre">salary</span></code>に影響を与えない。</p>
<p><span class="math notranslate nohighlight">\(H_0:\;\beta_{\text{years}}=\beta_{\text{gamesyr}}=\beta_{\text{bavg}}=\beta_{\text{hrunsyr}}=\beta_{\text{rbisyr}}=0\)</span></p>
<p><span class="math notranslate nohighlight">\(H_A:\;H_0は成立しない\)</span></p>
<p>この場合，<code class="docutils literal notranslate"><span class="pre">res_0</span></code>の<code class="docutils literal notranslate"><span class="pre">fvalue</span></code>から<span class="math notranslate nohighlight">\(F\)</span>値，<code class="docutils literal notranslate"><span class="pre">f_pvalue</span></code>から<span class="math notranslate nohighlight">\(p\)</span>値を属性として取得できる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_0</span><span class="o">.</span><span class="n">fvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>117.0603200852145
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res_0</span><span class="o">.</span><span class="n">f_pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.9380422932206435e-72
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(p\)</span>値は非常に小さな値となっており、0.1%の有意水準でも帰無仮説を棄却できる。</p>
<p>例２の結果はOLS推定結果のメソッド<code class="docutils literal notranslate"><span class="pre">summary()</span></code>で表示される表の中にある<code class="docutils literal notranslate"><span class="pre">F-statistic</span></code>と<code class="docutils literal notranslate"><span class="pre">Prob(F-statistic)</span></code>で確認することもできる。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">res_0</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:         np.log(salary)   R-squared:                       0.628
Model:                            OLS   Adj. R-squared:                  0.622
Method:                 Least Squares   F-statistic:                     117.1
Date:                Sun, 06 Aug 2023   Prob (F-statistic):           2.94e-72
Time:                        06:47:59   Log-Likelihood:                -385.11
No. Observations:                 353   AIC:                             782.2
Df Residuals:                     347   BIC:                             805.4
Df Model:                           5                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept     11.1924      0.289     38.752      0.000      10.624      11.760
years          0.0689      0.012      5.684      0.000       0.045       0.093
gamesyr        0.0126      0.003      4.742      0.000       0.007       0.018
bavg           0.0010      0.001      0.887      0.376      -0.001       0.003
hrunsyr        0.0144      0.016      0.899      0.369      -0.017       0.046
rbisyr         0.0108      0.007      1.500      0.134      -0.003       0.025
==============================================================================
Omnibus:                        6.816   Durbin-Watson:                   1.265
Prob(Omnibus):                  0.033   Jarque-Bera (JB):               10.197
Skew:                          -0.068   Prob(JB):                      0.00610
Kurtosis:                       3.821   Cond. No.                     2.09e+03
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 2.09e+03. This might indicate that there are
strong multicollinearity or other numerical problems.
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="10_Residuals.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">残差診断</p>
      </div>
    </a>
    <a class="right-next"
       href="12_Asymptotics.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">大標本特性</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">説明：仮説検定</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#t"><span class="math notranslate nohighlight">\(t\)</span>検定</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tp">説明：<span class="math notranslate nohighlight">\(t\)</span>値と<span class="math notranslate nohighlight">\(p\)</span>値</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><span class="math notranslate nohighlight">\(t\)</span>値と<span class="math notranslate nohighlight">\(p\)</span>値の例</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><span class="math notranslate nohighlight">\(t\)</span>値</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#p"><span class="math notranslate nohighlight">\(p\)</span>値</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">回帰分析と<span class="math notranslate nohighlight">\(t\)</span>検定</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">信頼区間</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">信頼区間の計算</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">信頼区間の図示</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#f"><span class="math notranslate nohighlight">\(F\)</span>検定</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">説明</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">回帰分析</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">例１</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">手計算</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">メソッドを使う</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">例２</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 春山 鉄源  Tetsugen HARUYAMA
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2020-2023（公開開始日：2020年5月4日）.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <!-- Default Statcounter code for Py4etrics https://py4etrics.github.io/ --> <script type="text/javascript"> var sc_project=12340470; var sc_invisible=1; var sc_security="72befddb"; </script> <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script> <noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12340470/0/72befddb/1/" alt="Web Analytics"></a></div></noscript> <!-- End of Statcounter Code -->
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>